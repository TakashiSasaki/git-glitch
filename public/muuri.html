<html>
  <head>
    <!-- <script src="https://unpkg.com/web-animations-js@2.3.1/web-animations.min.js"></script> -->
    <link rel="manifest" href="/manifest.json">
    <script src="/pwa.js"></script>
    <script src="https://unpkg.com/hammerjs@2.0.8/hammer.min.js"></script>
    <script src="https://unpkg.com/muuri@0.7.1/dist/muuri.min.js"></script>  
    <!--<script src="https://www.gstatic.com/firebasejs/5.8.5/firebase.js" ></script>-->
    <script src="/firebase-5.8.0.js" ></script>
    <script src="/firebase-config.js"></script>
    <link rel="stylesheet" href="/style.css" type="text/css">
  </head>
  <html>
    <div class="grid">
      <div class="item">
        <div class="item-content">
              aaab
        </div>
      </div>
      <div class="item">
        <div class="item-content">
              bbba
        </div>
      </div>
      <div class="item">
        <div class="item-content">
              123
        </div>
      </div>
      <div class="item">
        <div class="item-content">
              456
        </div>
      </div>
    </div>
    <textarea>aaa</textarea>
    <script>
      firebase.initializeApp(config);
      var provider = new firebase.auth.GoogleAuthProvider();
      console.log("currentUser = " +ã€€firebase.auth().currentUser);
      function signIn(){
        firebase.auth().signInWithPopup(provider).then(function(result) {
            // This gives you a Google Access Token. You can use it to access the Google API.
            console.log("accessToken = " + result.credential.accessToken);
            console.log("currentUser = " + firebase.auth().currentUser);
            //document.getElementById("firebase-auth-log").value = JSON.stringify(result.user);
        }).catch(function(error) {
            console.log(JSON.stringify(error));
            //document.getElementById("firebase-auth-log").value = JSON.stringify(error);
        });
      }
      
      const getIdToken = ()=> {
        return new Promise((resolve, reject) => {
          const unsubscribe = firebase.auth().onAuthStateChanged((user)=> {
            unsubscribe();
            if(user) {
              user.getIdToken().then((idToken) => {
                resolve(idToken);
              }, (error)=>{
                resolve(null);
              });
            } else {
              resolve(null);
            }
          });
        });
      };
      
      getIdToken((idToken) => {console.log(idToken);});
    </script>
    <script>
      var textarea = document.getElementsByTagName("textarea")[0];
      var grid = new Muuri(".grid" , {dragEnabled: true});
      grid.on("layoutEnd", function(x){
        textarea.value += x;
      });
    </script>
    
  </html>
</html>
